// import constants from "./constants.js";
console.clear();

const CONSTANTS = await import('./constants.js');
const IPSReader = await import('./ipsReader.js');

var ipsBytes = [];
var ipsFileName;

var ipsFilePicker = document.getElementById('ipsFilePicker');
var ipsReaderStatusList = document.getElementById('ipsReaderStatusList');
var pageContainer = document.getElementById('pageContainer');

function toHex(d) {
    return ("0" + (Number(d).toString(16))).slice(-2).toUpperCase()
}

function OnFileSelected(e) {
    if (document.getElementById('loadingPatchStatusItem') != null)
        document.getElementById('loadingPatchStatusItem').remove();

    ipsReaderStatusList.classList.remove('d-none');
    ClearStatusList();
    let loadingStatus = GenerateNewListItem('Loading...', ipsReaderStatusList);
    loadingStatus.id = 'loadingPatchStatusItem';

    var file = e.target.files[0];

    var reader = new FileReader();
    reader.readAsArrayBuffer(file);

    reader.onload = (readerEvent) => FileReaderOnLoad(readerEvent, file.name);
}

function FileReaderOnLoad(readerEvent, fileName) {
    let content = readerEvent.target.result;
    let bytes = new Uint8Array(content);
    ipsBytes = bytes;
    ipsFileName = fileName;

    let loadingPatchStatusItem = document.getElementById('loadingPatchStatusItem');
    loadingPatchStatusItem.classList.add('list-group-item-success');
    loadingPatchStatusItem.childNodes[0].replaceWith(loadingPatchStatusItem.childNodes[0].textContent + 'success!');

    ReadIPSFile();
}

function GenerateNewListItem(text, parent) {
    let listItem = document.createElement('li');
    listItem.classList.add('list-group-item')

    if (parent == null || parent == undefined) {
        parent = text;
        text = null;
    } else {
        let label = document.createElement('label');
        label.textContent = text;
        // label.classList.add('col-sm-5');

        listItem.appendChild(label);
    }

    parent.appendChild(listItem);

    return listItem;
}

function SetupListeners() {
    ipsFilePicker.onchange = OnFileSelected;
}

function ReadIPSFile() {
    let readingStatus = GenerateNewListItem('Reading...', ipsReaderStatusList);

    let fileHeader = String.fromCharCode(...ipsBytes.slice(0, 5));
    let fileEOF = String.fromCharCode(...ipsBytes.slice(-3));

    let patches = IPSReader.ProcessIPS(ipsBytes);
    let patchStrings = [];
    let totalBytes = 0;

    for (let i = 0; i < patches.length; i++) {
        let patch = patches[i];
        if (patch.rle) {
            let bytesString = `${toHex(patch.bytes[0])} x ${patch.size}`;
            patchStrings.push(`Patch ${i}: (HLE) Offset: 0x${patch.offset.toString(16)}, Size: (${patch.size}), Bytes: ${bytesString}`);
            totalBytes += patch.size;
        } else {
            // let bytesString = patch.bytes.slice(0, 20).map(b => toHex(b)).join(', ') + (patch.bytes.length > 20 ? '...' : '');
            let bytesString = patch.bytes.slice(0, 20).map(b => b.toString(16)).join(', ') + (patch.bytes.length > 20 ? '...' : '');
            patchStrings.push(`Patch ${i}: Offset: 0x${patch.offset.toString(16)}, Size: (${patch.size}), Bytes: ${bytesString}`);
            totalBytes += patch.size;
        }
    }

    readingStatus.innerHTML += `successful. Valid Header Found: ${fileHeader}...${fileEOF} Patch Count(${patches.length}) Total Bytes(0x${totalBytes.toString(16)})<br/>`;
    readingStatus.innerHTML += patchStrings.join('<br/>');
    readingStatus.classList.add('list-group-item-success');
}

function ClearStatusList() {
    while (ipsReaderStatusList.firstChild) {
        ipsReaderStatusList.removeChild(ipsReaderStatusList.lastChild);
    }
}

function Initialize() {
    ipsReaderStatusList.classList.remove('d-none');
}

function DebugMessage(text) {
    var element = document.createElement('h4');
    element.appendChild(document.createTextNode(text));
    document.body.appendChild(element);

    console.log(text);
}

SetupListeners();

let testButton = document.createElement('BUTTON');
testButton.classList.add('my-2', 'btn', 'btn-primary');
testButton.innerText = 'RUN TEST DATA';
testButton.onclick = () => {
    ipsReaderStatusList.classList.remove('d-none');
    ClearStatusList();

    if (ipsBytes.length == 0)
        // ipsBytes = [0x50, 0x41, 0x54, 0x43, 0x48, 0x08, 0x24, 0x93, 0x00, 0x02, 0x80, 0x0D, 0x45, 0x4F, 0x46];
        ipsBytes = [0x50, 0x41, 0x54, 0x43, 0x48, 0x01, 0x6E, 0xB7, 0x00, 0x0B, 0x9C, 0x9F, 0x07, 0x9C, 0x8B, 0x07, 0x80, 0x02, 0xEA, 0xEA, 0x80, 0x45, 0x4F, 0x46]
        // ipsBytes = [0x50, 0x41, 0x54, 0x43, 0x48, 0x08, 0x29, 0x7C, 0x00, 0x03, 0xE2, 0x20, 0xBD, 0x08, 0x76, 0x3A, 0x00, 0x24, 0xAD, 0x23, 0x0A, 0x29, 0xFF, 0x00, 0xC9, 0x03, 0x00, 0xF0, 0x13, 0xC9, 0x02, 0x00, 0xF0, 0x0E, 0xC9, 0x06, 0x00, 0xF0, 0x09, 0xC9, 0x14, 0x00, 0xF0, 0x04, 0x22, 0xBC, 0x98, 0x90, 0x6B, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0x08, 0x9E, 0xE2, 0x0D, 0x0A, 0xDC, 0xA0, 0xEA, 0xA0, 0x70, 0xA1, 0xEA, 0xA0, 0x70, 0xA1, 0xEA, 0xA0, 0x70, 0xA1, 0xEA, 0xA0, 0x70, 0xA1, 0xF0, 0xA1, 0x3A, 0xA2, 0x84, 0xA2, 0xC8, 0xA2, 0xF0, 0xA1, 0x3A, 0xA2, 0xF0, 0xA1, 0x3A, 0xA2, 0xF0, 0xA1, 0x3A, 0xA2, 0x0C, 0xA3, 0x56, 0xA3, 0xA0, 0xA3, 0xF6, 0xA3, 0x4C, 0xA4, 0xA8, 0xA4, 0x04, 0xA5, 0x4E, 0xA5, 0x98, 0xA5, 0xE2, 0xA5, 0x2C, 0xA6, 0x2C, 0xA6, 0x38, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x54, 0xA6, 0x68, 0xA6, 0x7C, 0xA6, 0xC0, 0xA6, 0x04, 0xA7, 0x42, 0xA7, 0x04, 0xA7, 0x42, 0xA7, 0x80, 0xA7, 0xC4, 0xA7, 0x52, 0xA6, 0x52, 0xA6, 0x08, 0xA8, 0x14, 0xA8, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x38, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x2E, 0xA8, 0x42, 0xA8, 0x52, 0xA6, 0x52, 0xA6, 0x56, 0xA8, 0x82, 0xA8, 0x52, 0xA6, 0x52, 0xA6, 0xA0, 0xA3, 0xF6, 0xA3, 0xAE, 0xA8, 0xC2, 0xA8, 0xA0, 0xA3, 0xF6, 0xA3, 0xD6, 0xA8, 0xDE, 0xA8, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0xE6, 0xA8, 0x24, 0xA9, 0xA0, 0xA3, 0xF6, 0xA3, 0xA0, 0xA3, 0xF6, 0xA3, 0x04, 0xA7, 0x42, 0xA7, 0x04, 0xA7, 0x42, 0xA7, 0x7C, 0xA6, 0xC0, 0xA6, 0x7C, 0xA6, 0xC0, 0xA6, 0x56, 0xA8, 0x82, 0xA8, 0x56, 0xA8, 0x82, 0xA8, 0x62, 0xA9, 0x6E, 0xA9, 0x62, 0xA9, 0x6E, 0xA9, 0x88, 0xA9, 0x8E, 0xA9, 0xA2, 0xA9, 0xA8, 0xA9, 0xBC, 0xA9, 0x06, 0xAA, 0x50, 0xAA, 0x76, 0xAA, 0x7C, 0xA6, 0xC0, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x9C, 0xAA, 0xE0, 0xAA, 0x24, 0xAB, 0x32, 0xAB, 0x24, 0xAB, 0x32, 0xAB, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0xDC, 0xA0, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0xEA, 0xA0, 0x70, 0xA1, 0xEA, 0xA0, 0x70, 0xA1, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x40, 0xAB, 0x40, 0xAB, 0x40, 0xAB, 0x40, 0xAB, 0x40, 0xAB, 0x24, 0xAB, 0x32, 0xAB, 0x24, 0xAB, 0x32, 0xAB, 0x24, 0xAB, 0x32, 0xAB, 0x52, 0xA6, 0x52, 0xA6, 0x7E, 0xAB, 0x92, 0xAB, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x9C, 0xAA, 0xE0, 0xAA, 0x9C, 0xAA, 0xE0, 0xAA, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0xA6, 0xAB, 0xEA, 0xA0, 0x70, 0xA1, 0xEA, 0xA0, 0x70, 0xA1, 0xEA, 0xA0, 0x70, 0xA1, 0xEA, 0xA0, 0x70, 0xA1, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0xAE, 0xAB, 0xAE, 0xAB, 0xAE, 0xAB, 0xAE, 0xAB, 0xAE, 0xAB, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x52, 0xA6, 0x00, 0x00, 0x00, 0x01, 0x26, 0x00, 0x00, 0x00, 0x00, 0x02, 0x25, 0x00, 0xFF, 0xFF, 0x80, 0x00, 0x00, 0x08, 0x55, 0x00, 0x80, 0x00, 0x10, 0x00, 0x57, 0x00, 0x80, 0x00, 0x20, 0x00, 0x59, 0x00, 0x80, 0x00, 0x00, 0x00, 0x4B, 0x00, 0x00, 0x04, 0x30, 0x00, 0xF1, 0x00, 0x00, 0x04, 0x10, 0x00, 0xF3, 0x00, 0x00, 0x04, 0x20, 0x00, 0xF5, 0x00, 0x00, 0x04, 0x00, 0x00, 0x35, 0x00, 0x00, 0x00, 0x60, 0x02, 0x78, 0x00, 0x00, 0x00, 0x50, 0x02, 0x76, 0x00, 0x00, 0x00, 0x30, 0x02, 0x25, 0x00, 0x00, 0x00, 0x30, 0x00, 0x03, 0x00, 0x00, 0x00, 0x10, 0x01, 0x0F, 0x00, 0x00, 0x00, 0x20, 0x01, 0x11, 0x00, 0x00, 0x00, 0x00, 0x09, 0x0F, 0x00, 0x00, 0x00, 0x00, 0x05, 0x11, 0x00, 0x00, 0x00, 0x40, 0x02, 0x4A, 0x00, 0x00, 0x00, 0x00, 0x02, 0x25, 0x00, 0x00, 0x00, 0x00, 0x08, 0x03, 0x00, 0x00, 0x00, 0x10, 0x00, 0x05, 0x00, 0x00, 0x00, 0x20, 0x00, 0x07, 0x00, 0x00, 0x00, 0x00, 0x01, 0x09, 0x00, 0xFF, 0xFF, 0x80, 0x00, 0x00, 0x08, 0x56, 0x00, 0x80, 0x00, 0x10, 0x00, 0x58, 0x00, 0x80, 0x00, 0x20, 0x00, 0x5A, 0x00, 0x80, 0x00, 0x00, 0x00, 0x4C, 0x00, 0x00, 0x04, 0x30, 0x00, 0xF2, 0x00, 0x00, 0x04, 0x10, 0x00, 0xF4, 0x00, 0x00, 0x04, 0x20, 0x00, 0xF6, 0x00, 0x00, 0x04, 0x00, 0x00, 0x36, 0x00, 0x00, 0x00, 0x60, 0x01, 0x77, 0x00, 0x00, 0x00, 0x50, 0x01, 0x75, 0x00, 0x00, 0x00, 0x40, 0x01, 0x49, 0x00, 0x00, 0x00, 0x00, 0x01, 0x26, 0x00, 0x00, 0x00, 0x30, 0x00, 0x04, 0x00, 0x00, 0x00, 0x10, 0x02, 0x10, 0x00, 0x00, 0x00, 0x20, 0x02, 0x12, 0x00, 0x00, 0x00, 0x00, 0x0A, 0x10, 0x00, 0x00, 0x00, 0x00, 0x06, 0x12, 0x00, 0x00, 0x00, 0x00, 0x08, 0x04, 0x00, 0x00, 0x00, 0x10, 0x00, 0x06, 0x00, 0x00, 0x00, 0x20, 0x00, 0x08, 0x00, 0x00, 0x00, 0x00, 0x02, 0x0A, 0x00, 0xFF, 0xFF, 0x00, 0x04, 0x00, 0x00, 0x35, 0x00, 0x80, 0x00, 0x00, 0x00, 0x19, 0x00, 0x00, 0x00, 0x10, 0x01, 0x0F, 0x00, 0x00, 0x00, 0x20, 0x01, 0x11, 0x00, 0x00, 0x00, 0x00, 0x09, 0x0F, 0x00, 0x00, 0x00, 0x00, 0x05, 0x11, 0x00, 0x00, 0x00, 0x40, 0x01, 0x0B, 0x00, 0x00, 0x00, 0x00, 0x01, 0x09, 0x00, 0x00, 0x00, 0x00, 0x02, 0x25, 0x00, 0x00, 0x00, 0x00, 0x08, 0x03, 0x00, 0x00, 0x00, 0x10, 0x00, 0x05, 0x00, 0x00, 0x00, 0x20, 0x00, 0x07, 0x00, 0xFF, 0xFF, 0x00, 0x04, 0x00, 0x00, 0x36, 0x00, 0x80, 0x00, 0x00, 0x00, 0x1A, 0x00, 0x00, 0x00, 0x10, 0x02, 0x10, 0x00, 0x00, 0x00, 0x20, 0x02, 0x12, 0x00, 0x00, 0x00, 0x00, 0x0A, 0x10, 0x00, 0x00, 0x00, 0x00, 0x06, 0x12, 0x00, 0x00, 0x00, 0x40, 0x02, 0x0C, 0x00, 0x00, 0x00, 0x00, 0x02, 0x0A, 0x00, 0x00, 0x00, 0x00, 0x01, 0x26, 0x00, 0x00, 0x00, 0x00, 0x08, 0x04, 0x00, 0x00, 0x00, 0x10, 0x00, 0x06, 0x00, 0x00, 0x00, 0x20, 0x00, 0x08, 0x00, 0xFF, 0xFF, 0x00, 0x04, 0x00, 0x00, 0x35, 0x00, 0x80, 0x00, 0x00, 0x00, 0x19, 0x00, 0x00, 0x00, 0x10, 0x01, 0x0F, 0x00, 0x00, 0x00, 0x20, 0x01, 0x11, 0x00, 0x00, 0x00, 0x00, 0x09, 0x0F, 0x00, 0x00, 0x00, 0x00, 0x05, 0x11, 0x00, 0x00, 0x00, 0x00, 0x01, 0x0B, 0x00, 0x00, 0x00, 0x00, 0x02, 0x25, 0x00, 0x00, 0x00, 0x00, 0x08, 0x03, 0x00, 0x00, 0x00, 0x10, 0x00, 0x05, 0x00, 0x00, 0x00, 0x20, 0x00, 0x07, 0x00, 0xFF, 0xFF, 0x00, 0x04, 0x00, 0x00, 0x36, 0x00, 0x80, 0x00, 0x00, 0x00, 0x1A, 0x00, 0x00, 0x00, 0x10, 0x02, 0x10, 0x00, 0x00, 0x00, 0x20, 0x02, 0x12, 0x00, 0x00, 0x00, 0x00, 0x0A, 0x10, 0x00, 0x00, 0x00, 0x00, 0x06, 0x12, 0x00, 0x00, 0x00, 0x00, 0x02, 0x0C, 0x00, 0x00, 0x00, 0x00, 0x01, 0x26, 0x00, 0x00, 0x00, 0x00, 0x08, 0x04, 0x00, 0x00, 0x00, 0x10, 0x00, 0x06, 0x00, 0x00, 0x00, 0x20, 0x00, 0x08, 0x00, 0xFF, 0xFF, 0x80, 0x00, 0x00, 0x00, 0x19, 0x00, 0x00, 0x00, 0x00, 0x09, 0x69, 0x00, 0x00, 0x00, 0x00, 0x05, 0x6B, 0x00, 0x00, 0x00, 0x90, 0x01, 0x69, 0x00, 0x00, 0x00, 0xA0, 0x01, 0x6B, 0x00, 0x00, 0x00, 0x00, 0x02, 0x2F, 0x00, 0x00, 0x00, 0x00, 0x08, 0x15, 0x00, 0x00, 0x00, 0x00, 0x04, 0x17, 0x00, 0x00, 0x00, 0x10, 0x00, 0x69, 0x00, 0x00, 0x00, 0x20, 0x00, 0x6B, 0x00, 0x00, 0x00, 0x00, 0x01, 0x51, 0x00, 0x00, 0x00, 0x40, 0x00, 0x13, 0x00, 0xFF, 0xFF, 0x80, 0x00, 0x00, 0x00, 0x1A, 0x00, 0x00, 0x00, 0x00, 0x0A, 0x6A, 0x00, 0x00, 0x00, 0x00, 0x06, 0x6C, 0x00, 0x00, 0x00, 0x90, 0x02, 0x6A, 0x00, 0x00, 0x00, 0xA0, 0x02, 0x6C, 0x00, 0x00, 0x00, 0x00, 0x01, 0x30, 0x00, 0x00, 0x00, 0x00, 0x08, 0x16, 0x00, 0x00, 0x00, 0x00, 0x04, 0x18, 0x00, 0x00, 0x00, 0x10, 0x00, 0x6A, 0x00, 0x00, 0x00, 0x20, 0x00, 0x6C, 0x00, 0x00, 0x00, 0x00, 0x02, 0x52, 0x00, 0x00, 0x00, 0x40, 0x00, 0x14, 0x00, 0xFF, 0xFF, 0x80, 0x00, 0x00, 0x00, 0x19, 0x00, 0x00, 0x00, 0x00, 0x09, 0x69, 0x00, 0x00, 0x00, 0x00, 0x05, 0x6B, 0x00, 0x00, 0x00, 0x90, 0x01, 0x69, 0x00, 0x00, 0x00, 0xA0, 0x01, 0x6B, 0x00, 0x00, 0x00, 0x00, 0x02, 0x2F, 0x00, 0x00, 0x00, 0x00, 0x08, 0x15, 0x00, 0x00, 0x00, 0x00, 0x04, 0x17, 0x00, 0x00, 0x00, 0x10, 0x00, 0x69, 0x00, 0x00, 0x00, 0x20, 0x00, 0x6B, 0x00, 0x00, 0x00, 0x00, 0x01, 0x51, 0x00, 0x00, 0x00, 0xC0, 0x00, 0x13, 0x00, 0x00, 0x00, 0x80, 0x00, 0x4D, 0x00, 0x00, 0x00, 0x40, 0x00, 0x13, 0x00, 0xFF, 0xFF, 0x80, 0x00, 0x00, 0x00, 0x1A, 0x00, 0x00, 0x00, 0x00, 0x0A, 0x6A, 0x00, 0x00, 0x00, 0x00, 0x06, 0x6C, 0x00, 0x00, 0x00, 0x90, 0x02, 0x6A, 0x00, 0x00, 0x00, 0xA0, 0x02, 0x6C, 0x00, 0x00, 0x00, 0x00, 0x01, 0x30, 0x00, 0x00, 0x00, 0x00, 0x08, 0x16, 0x00, 0x00, 0x00, 0x00, 0x04, 0x18, 0x00, 0x00, 0x00, 0x10, 0x00, 0x6A, 0x00, 0x00, 0x00, 0x20, 0x00, 0x6C, 0x00, 0x00, 0x00, 0x00, 0x02, 0x52, 0x00, 0x00, 0x00, 0xC0, 0x00, 0x14, 0x00, 0x00, 0x00, 0x80, 0x00, 0x4E, 0x00, 0x00, 0x00, 0x40, 0x00, 0x14, 0x00, 0xFF, 0xFF, 0x80, 0x00, 0x00, 0x00, 0x19, 0x00, 0x00, 0x04, 0x00, 0x00, 0x37, 0x00, 0x00, 0x00, 0x00, 0x09, 0x69, 0x00, 0x00, 0x00, 0x00, 0x05, 0x6B, 0x00, 0x00, 0x00, 0x90, 0x01, 0x69, 0x00, 0x00, 0x00, 0xA0, 0x01, 0x6B, 0x00, 0x00, 0x00, 0x00, 0x02, 0x2F, 0x00, 0x00, 0x00, 0x00, 0x08, 0x15, 0x00, 0x00, 0x00, 0x00, 0x04, 0x17, 0x00, 0x00, 0x00, 0x10, 0x00, 0x69, 0x00, 0x00, 0x00, 0x20, 0x00, 0x6B, 0x00, 0x00, 0x00, 0x00, 0x01, 0x51, 0x00, 0x00, 0x00, 0xC0, 0x00, 0x13, 0x00, 0x00, 0x00, 0x80, 0x00, 0x17, 0x00, 0x00, 0x00, 0x40, 0x00, 0x13, 0x00, 0xFF, 0xFF, 0x80, 0x00, 0x00, 0x00, 0x1A, 0x00, 0x00, 0x04, 0x00, 0x00, 0x38, 0x00, 0x00, 0x00, 0x00, 0x0A, 0x6A, 0x00, 0x00, 0x00, 0x00, 0x06, 0x6C, 0x00, 0x00, 0x00, 0x90, 0x02, 0x6A, 0x00, 0x00, 0x00, 0xA0, 0x02, 0x6C, 0x00, 0x00, 0x00, 0x00, 0x01, 0x30, 0x00, 0x00, 0x00, 0x00, 0x08, 0x16, 0x00, 0x00, 0x00, 0x00, 0x04, 0x18, 0x00, 0x00, 0x00, 0x10, 0x00, 0x6A, 0x00, 0x00, 0x00, 0x20, 0x00, 0x6C, 0x00, 0x00, 0x00, 0x00, 0x02, 0x52, 0x00, 0x00, 0x00, 0xC0, 0x00, 0x14, 0x00, 0x00, 0x00, 0x80, 0x00, 0x18, 0x00, 0x00, 0x00, 0x40, 0x00, 0x14, 0x00, 0xFF, 0xFF, 0x40, 0x00, 0x00, 0x00, 0x13, 0x00, 0x00, 0x00, 0x40, 0x08, 0x15, 0x00, 0x00, 0x00, 0x40, 0x04, 0x17, 0x00, 0x00, 0x00, 0x50, 0x00, 0x69, 0x00, 0x00, 0x00, 0x60, 0x00, 0x6B, 0x00, 0x00, 0x00, 0x80, 0x01, 0x19, 0x00, 0x00, 0x00, 0x00, 0x08, 0x15, 0x00, 0x00, 0x00, 0x10, 0x00, 0x69, 0x00, 0x00, 0x00, 0x20, 0x00, 0x6B, 0x00, 0x00, 0x00, 0x00, 0x04, 0x17, 0x00, 0x00, 0x00, 0x00, 0x01, 0x19, 0x00, 0x00, 0x00, 0x00, 0x02, 0x1A, 0x00, 0xFF, 0xFF, 0x40, 0x00, 0x00, 0x00, 0x14, 0x00, 0x00, 0x00, 0x40, 0x08, 0x16, 0x00, 0x00, 0x00, 0x40, 0x04, 0x18, 0x00, 0x00, 0x00, 0x50, 0x00, 0x6A, 0x00, 0x00, 0x00, 0x60, 0x00, 0x6C, 0x00, 0x00, 0x00, 0x80, 0x02, 0x1A, 0x00, 0x00, 0x00, 0x00, 0x08, 0x16, 0x00, 0x00, 0x00, 0x10, 0x00, 0x6A, 0x00, 0x00, 0x00, 0x20, 0x00, 0x6C, 0x00, 0x00, 0x00, 0x00, 0x04, 0x18, 0x00, 0x00, 0x00, 0x00, 0x02, 0x1A, 0x00, 0x00, 0x00, 0x00, 0x01, 0x19, 0x00, 0xFF, 0xFF, 0x40, 0x00, 0x00, 0x00, 0x13, 0x00, 0x00, 0x00, 0x40, 0x08, 0x15, 0x00, 0x00, 0x00, 0x40, 0x04, 0x17, 0x00, 0x00, 0x00, 0x50, 0x00, 0x69, 0x00, 0x00, 0x00, 0x60, 0x00, 0x6B, 0x00, 0x00, 0x00, 0x80, 0x01, 0x1B, 0x00, 0x00, 0x00, 0x00, 0x08, 0x15, 0x00, 0x00, 0x00, 0x10, 0x00, 0x69, 0x00, 0x00, 0x00, 0x20, 0x00, 0x6B, 0x00, 0x00, 0x00, 0x00, 0x04, 0x17, 0x00, 0x00, 0x00, 0x00, 0x01, 0x1B, 0x00, 0x00, 0x00, 0x00, 0x02, 0x1C, 0x00, 0xFF, 0xFF, 0x40, 0x00, 0x00, 0x00, 0x14, 0x00, 0x00, 0x00, 0x40, 0x08, 0x16, 0x00, 0x00, 0x00, 0x40, 0x04, 0x18, 0x00, 0x00, 0x00, 0x50, 0x00, 0x6A, 0x00, 0x00, 0x00, 0x60, 0x00, 0x6C, 0x00, 0x00, 0x00, 0x80, 0x02, 0x1C, 0x00, 0x00, 0x00, 0x00, 0x08, 0x16, 0x00, 0x00, 0x00, 0x10, 0x00, 0x6A, 0x00, 0x00, 0x00, 0x20, 0x00, 0x6C, 0x00, 0x00, 0x00, 0x00, 0x04, 0x18, 0x00, 0x00, 0x00, 0x00, 0x02, 0x1C, 0x00, 0x00, 0x00, 0x00, 0x01, 0x1B, 0x00, 0xFF, 0xFF, 0x00, 0x08, 0x00, 0x00, 0x3D, 0x00, 0x80, 0x00, 0x00, 0x00, 0x3D, 0x00, 0x00, 0x08, 0x00, 0x00, 0x3E, 0x00, 0x80, 0x00, 0x00, 0x00, 0x3E, 0x00, 0x00, 0x00, 0x00, 0x01, 0x1E, 0x00, 0x00, 0x00, 0x00, 0x02, 0x1F, 0x00, 0xFF, 0xFF, 0xFF, 0xFF, 0x00, 0x00, 0x80, 0x02, 0x1A, 0x00, 0x80, 0x00, 0x00, 0x00, 0x4C, 0x00, 0x00, 0x00, 0x00, 0x02, 0x25, 0x00, 0xFF, 0xFF, 0x00, 0x00, 0x80, 0x01, 0x19, 0x00, 0x80, 0x00, 0x00, 0x00, 0x4B, 0x00, 0x00, 0x00, 0x00, 0x01, 0x26, 0x00, 0xFF, 0xFF, 0x00, 0x08, 0x30, 0x00, 0xF7, 0x00, 0x00, 0x08, 0x10, 0x00, 0xF9, 0x00, 0x00, 0x08, 0x20, 0x00, 0xFB, 0x00, 0x00, 0x08, 0x00, 0x00, 0x3B, 0x00, 0x00, 0x02, 0x00, 0x00, 0x43, 0x00, 0x00, 0x04, 0x00, 0x00, 0x37, 0x00, 0x80, 0x00, 0x00, 0x00, 0x4B, 0x00, 0x00, 0x00, 0x30, 0x00, 0x85, 0x00, 0x00, 0x00, 0x00, 0x01, 0x01, 0x00, 0x00, 0x00, 0x10, 0x00, 0x71, 0x00, 0x00, 0x00, 0x20, 0x00, 0x73, 0x00, 0xFF, 0xFF, 0x00, 0x08, 0x30, 0x00, 0xF8, 0x00, 0x00, 0x08, 0x10, 0x00, 0xFA, 0x00, 0x00, 0x08, 0x20, 0x00, 0xFC, 0x00, 0x00, 0x08, 0x00, 0x00, 0x3C, 0x00, 0x00, 0x01, 0x00, 0x00, 0x44, 0x00, 0x00, 0x04, 0x00, 0x00, 0x38, 0x00, 0x80, 0x00, 0x00, 0x00, 0x4C, 0x00, 0x00, 0x00, 0x30, 0x00, 0x86, 0x00, 0x00, 0x00, 0x00, 0x02, 0x02, 0x00, 0x00, 0x00, 0x10, 0x00, 0x72, 0x00, 0x00, 0x00, 0x20, 0x00, 0x74, 0x00, 0xFF, 0xFF, 0x80, 0x00, 0x00, 0x00, 0x19, 0x00, 0x00, 0x00, 0x00, 0x09, 0x6D, 0x00, 0x00, 0x00, 0x00, 0x05, 0x6F, 0x00, 0x00, 0x00, 0x00, 0x02, 0x87, 0x00, 0x00, 0x00, 0x00, 0x08, 0x2B, 0x00, 0x00, 0x00, 0x00, 0x04, 0x2D, 0x00, 0x00, 0x00, 0x10, 0x00, 0x6D, 0x00, 0x00, 0x00, 0x20, 0x00, 0x6F, 0x00, 0x00, 0x00, 0x40, 0x00, 0x67, 0x00, 0x00, 0x00, 0x00, 0x01, 0x29, 0x00, 0xFF, 0xFF, 0x80, 0x00, 0x00, 0x00, 0x1A, 0x00, 0x00, 0x00, 0x00, 0x0A, 0x6E, 0x00, 0x00, 0x00, 0x00, 0x06, 0x70, 0x00, 0x00, 0x00, 0x00, 0x01, 0x88, 0x00, 0x00, 0x00, 0x00, 0x08, 0x2C, 0x00, 0x00, 0x00, 0x00, 0x04, 0x2E, 0x00, 0x00, 0x00, 0x10, 0x00, 0x6E, 0x00, 0x00, 0x00, 0x20, 0x00, 0x70, 0x00, 0x00, 0x00, 0x40, 0x00, 0x68, 0x00, 0x00, 0x00, 0x00, 0x02, 0x2A, 0x00, 0xFF, 0xFF, 0x80, 0x00, 0x00, 0x00, 0x19, 0x00, 0x00, 0x04, 0x00, 0x00, 0x37, 0x00, 0x00, 0x00, 0x00, 0x09, 0x6D, 0x00, 0x00, 0x00, 0x00, 0x05, 0x6F, 0x00, 0x00, 0x00, 0x00, 0x08, 0x2B, 0x00, 0x00, 0x00, 0x00, 0x04, 0x2D, 0x00, 0x00, 0x00, 0x00, 0x02, 0x87, 0x00, 0x00, 0x00, 0x10, 0x00, 0x6D, 0x00, 0x00, 0x00, 0x20, 0x00, 0x6F, 0x00, 0x00, 0x00, 0x40, 0x00, 0x67, 0x00, 0x00, 0x00, 0x00, 0x01, 0x29, 0x00, 0xFF, 0xFF, 0x80, 0x00, 0x00, 0x00, 0x1A, 0x00, 0x00, 0x04, 0x00, 0x00, 0x38, 0x00, 0x00, 0x00, 0x00, 0x0A, 0x6E, 0x00, 0x00, 0x00, 0x00, 0x06, 0x70, 0x00, 0x00, 0x00, 0x00, 0x08, 0x2C, 0x00, 0x00, 0x00, 0x00, 0x04, 0x2E, 0x00, 0x00, 0x00, 0x00, 0x01, 0x88, 0x00, 0x00, 0x00, 0x10, 0x00, 0x6E, 0x00, 0x00, 0x00, 0x20, 0x00, 0x70, 0x00, 0x00, 0x00, 0x40, 0x00, 0x68, 0x00, 0x00, 0x00, 0x00, 0x02, 0x2A, 0x00, 0xFF, 0xFF, 0x00, 0x08, 0x00, 0x00, 0x3D, 0x00, 0x80, 0x00, 0x00, 0x00, 0x3D, 0x00, 0x00, 0x08, 0x00, 0x00, 0x3E, 0x00, 0x80, 0x00, 0x00, 0x00, 0x3E, 0x00, 0x00, 0x00, 0x00, 0x01, 0x31, 0x00, 0x00, 0x00, 0x00, 0x02, 0x32, 0x00, 0xFF, 0xFF, 0x00, 0x00, 0x40, 0x02, 0x45, 0x00, 0x00, 0x00, 0x00, 0x01, 0x09, 0x00, 0x00, 0x00, 0x00, 0x02, 0x25, 0x00, 0xFF, 0xFF, 0x00, 0x00, 0x40, 0x01, 0x46, 0x00, 0x00, 0x00, 0x00, 0x02, 0x0A, 0x00, 0x00, 0x00, 0x00, 0x01, 0x26, 0x00, 0xFF, 0xFF, 0x00, 0x04, 0x00, 0x00, 0x36, 0x00, 0x80, 0x00, 0x00, 0x00, 0xC0, 0x00, 0x00, 0x00, 0x60, 0x01, 0x77, 0x00, 0x00, 0x00, 0x50, 0x01, 0x75, 0x00, 0x00, 0x00, 0x40, 0x01, 0x49, 0x00, 0x00, 0x00, 0x00, 0x02, 0x0A, 0x00, 0x00, 0x00, 0x00, 0x01, 0x26, 0x00, 0xFF, 0xFF, 0x00, 0x04, 0x00, 0x00, 0x35, 0x00, 0x80, 0x00, 0x00, 0x00, 0xBF, 0x00, 0x00, 0x00, 0x50, 0x02, 0x76, 0x00, 0x00, 0x00, 0x60, 0x02, 0x78, 0x00, 0x00, 0x00, 0x40, 0x02, 0x4A, 0x00, 0x00, 0x00, 0x00, 0x01, 0x09, 0x00, 0x00, 0x00, 0x00, 0x02, 0x25, 0x00, 0xFF, 0xFF, 0x00, 0x00, 0x80, 0x02, 0x52, 0x00, 0x00, 0x00, 0x80, 0x01, 0x4F, 0x00, 0x00, 0x00, 0x80, 0x00, 0x4E, 0x00, 0xFF, 0xFF, 0x00, 0x00, 0x80, 0x02, 0x50, 0x00, 0x00, 0x00, 0x80, 0x01, 0x51, 0x00, 0x00, 0x00, 0x80, 0x00, 0x4D, 0x00, 0xFF, 0xFF, 0x00, 0x00, 0x80, 0x02, 0x50, 0x00, 0xFF, 0xFF, 0x00, 0x00, 0x80, 0x01, 0x4F, 0x00, 0xFF, 0xFF, 0x80, 0x00, 0x00, 0x00, 0x19, 0x00, 0x00, 0x00, 0x00, 0x09, 0x6D, 0x00, 0x00, 0x00, 0x00, 0x05, 0x6F, 0x00, 0x00, 0x00, 0x00, 0x08, 0x2B, 0x00, 0x00, 0x00, 0x00, 0x04, 0x2D, 0x00, 0x00, 0x00, 0x00, 0x02, 0x87, 0x00, 0x00, 0x00, 0x10, 0x00, 0x6D, 0x00, 0x00, 0x00, 0x20, 0x00, 0x6F, 0x00, 0x00, 0x00, 0x40, 0x00, 0x67, 0x00, 0x00, 0x00, 0x00, 0x01, 0x67, 0x00, 0xFF, 0xFF, 0x80, 0x00, 0x00, 0x00, 0x1A, 0x00, 0x00, 0x00, 0x00, 0x0A, 0x6E, 0x00, 0x00, 0x00, 0x00, 0x06, 0x70, 0x00, 0x00, 0x00, 0x00, 0x08, 0x2C, 0x00, 0x00, 0x00, 0x00, 0x04, 0x2E, 0x00, 0x00, 0x00, 0x00, 0x01, 0x88, 0x00, 0x00, 0x00, 0x10, 0x00, 0x6E, 0x00, 0x00, 0x00, 0x20, 0x00, 0x70, 0x00, 0x00, 0x00, 0x40, 0x00, 0x68, 0x00, 0x00, 0x00, 0x00, 0x02, 0x68, 0x00, 0xFF, 0xFF, 0x00, 0x08, 0x00, 0x00, 0x3D, 0x00, 0x80, 0x00, 0x00, 0x00, 0x7F, 0x00, 0x00, 0x08, 0x00, 0x00, 0x3E, 0x00, 0x80, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x00, 0x00, 0x01, 0x7B, 0x00, 0x00, 0x00, 0x00, 0x02, 0x7C, 0x00, 0xFF, 0xFF, 0x00, 0x08, 0x00, 0x00, 0x3D, 0x00, 0x00, 0x08, 0x00, 0x00, 0x3E, 0x00, 0x00, 0x00, 0x00, 0x01, 0x7D, 0x00, 0x00, 0x00, 0x00, 0x02, 0x7E, 0x00, 0xFF, 0xFF, 0x00, 0x08, 0x00, 0x00, 0x3D, 0x00, 0x00, 0x08, 0x00, 0x00, 0x3E, 0x00, 0x00, 0x00, 0x00, 0x01, 0x7F, 0x00, 0x00, 0x00, 0x00, 0x02, 0x80, 0x00, 0xFF, 0xFF, 0x40, 0x00, 0x00, 0x00, 0x13, 0x00, 0x00, 0x00, 0x40, 0x08, 0x15, 0x00, 0x00, 0x00, 0x40, 0x04, 0x17, 0x00, 0x00, 0x00, 0x50, 0x00, 0x69, 0x00, 0x00, 0x00, 0x60, 0x00, 0x6B, 0x00, 0x00, 0x00, 0x80, 0x01, 0x81, 0x00, 0x00, 0x00, 0x00, 0x08, 0x15, 0x00, 0x00, 0x00, 0x10, 0x00, 0x69, 0x00, 0x00, 0x00, 0x20, 0x00, 0x6B, 0x00, 0x00, 0x00, 0x00, 0x04, 0x17, 0x00, 0x00, 0x00, 0x00, 0x01, 0x81, 0x00, 0x00, 0x00, 0x00, 0x02, 0x82, 0x00, 0xFF, 0xFF, 0x40, 0x00, 0x00, 0x00, 0x14, 0x00, 0x00, 0x00, 0x40, 0x08, 0x16, 0x00, 0x00, 0x00, 0x40, 0x04, 0x18, 0x00, 0x00, 0x00, 0x50, 0x00, 0x6A, 0x00, 0x00, 0x00, 0x60, 0x00, 0x6C, 0x00, 0x00, 0x00, 0x80, 0x02, 0x82, 0x00, 0x00, 0x00, 0x00, 0x08, 0x16, 0x00, 0x00, 0x00, 0x10, 0x00, 0x6A, 0x00, 0x00, 0x00, 0x20, 0x00, 0x6C, 0x00, 0x00, 0x00, 0x00, 0x04, 0x18, 0x00, 0x00, 0x00, 0x00, 0x02, 0x82, 0x00, 0x00, 0x00, 0x00, 0x01, 0x81, 0x00, 0xFF, 0xFF, 0x00, 0x04, 0x00, 0x00, 0x37, 0x00, 0x00, 0x00, 0x00, 0x02, 0x1A, 0x00, 0x00, 0x00, 0x10, 0x00, 0x69, 0x00, 0x00, 0x00, 0x20, 0x00, 0x6B, 0x00, 0x00, 0x00, 0x40, 0x00, 0x13, 0x00, 0x00, 0x00, 0x80, 0x00, 0x83, 0x00, 0xFF, 0xFF, 0x00, 0x04, 0x00, 0x00, 0x38, 0x00, 0x00, 0x00, 0x00, 0x01, 0x19, 0x00, 0x00, 0x00, 0x10, 0x00, 0x6A, 0x00, 0x00, 0x00, 0x20, 0x00, 0x6C, 0x00, 0x00, 0x00, 0x40, 0x00, 0x14, 0x00, 0x00, 0x00, 0x80, 0x00, 0x84, 0x00, 0xFF, 0xFF, 0x80, 0x00, 0x00, 0x00, 0x4B, 0x00, 0x00, 0x00, 0x00, 0x09, 0x0F, 0x00, 0x00, 0x00, 0x00, 0x05, 0x11, 0x00, 0x00, 0x04, 0x00, 0x00, 0x35, 0x00, 0x00, 0x00, 0x20, 0x02, 0x78, 0x00, 0x00, 0x00, 0x10, 0x02, 0x76, 0x00, 0x00, 0x00, 0x00, 0x08, 0x03, 0x00, 0x00, 0x00, 0x10, 0x00, 0x05, 0x00, 0x00, 0x00, 0x20, 0x00, 0x07, 0x00, 0x00, 0x00, 0x00, 0x02, 0x25, 0x00, 0x00, 0x00, 0x00, 0x01, 0x09, 0x00, 0xFF, 0xFF, 0x80, 0x00, 0x00, 0x00, 0x4C, 0x00, 0x00, 0x00, 0x00, 0x0A, 0x10, 0x00, 0x00, 0x00, 0x00, 0x06, 0x12, 0x00, 0x00, 0x04, 0x00, 0x00, 0x36, 0x00, 0x00, 0x00, 0x20, 0x01, 0x77, 0x00, 0x00, 0x00, 0x10, 0x01, 0x75, 0x00, 0x00, 0x00, 0x00, 0x08, 0x04, 0x00, 0x00, 0x00, 0x10, 0x00, 0x06, 0x00, 0x00, 0x00, 0x20, 0x00, 0x08, 0x00, 0x00, 0x00, 0x00, 0x01, 0x26, 0x00, 0x00, 0x00, 0x00, 0x02, 0x0A, 0x00, 0xFF, 0xFF, 0x80, 0x00, 0x00, 0x02, 0x1A, 0x00, 0x80, 0x00, 0x00, 0x00, 0x4C, 0x00, 0xFF, 0xFF, 0x80, 0x00, 0x00, 0x01, 0x19, 0x00, 0x80, 0x00, 0x00, 0x00, 0x4B, 0x00, 0xFF, 0xFF, 0x00, 0x00, 0x40, 0x0A, 0xBB, 0x00, 0x00, 0x00, 0x40, 0x06, 0xBD, 0x00, 0x00, 0x00, 0x40, 0x02, 0xBC, 0x00, 0x00, 0x00, 0x10, 0x00, 0xBB, 0x00, 0x00, 0x00, 0x20, 0x00, 0xBD, 0x00, 0x00, 0x00, 0x40, 0x00, 0xBC, 0x00, 0x00, 0x00, 0x00, 0x02, 0xBE, 0x00, 0x00, 0x00, 0x00, 0x01, 0xBE, 0x00, 0x00, 0x00, 0x00, 0x08, 0xBE, 0x00, 0x00, 0x00, 0x00, 0x04, 0xBE, 0x00, 0xFF, 0xFF, 0x00, 0x00, 0x80, 0x08, 0xCB, 0x00, 0x00, 0x00, 0x90, 0x00, 0xCD, 0x00, 0x00, 0x00, 0x80, 0x01, 0xC9, 0x00, 0xFF, 0xFF, 0x00, 0x00, 0x80, 0x08, 0xCC, 0x00, 0x00, 0x00, 0x90, 0x00, 0xCE, 0x00, 0x00, 0x00, 0x80, 0x02, 0xCA, 0x00, 0xFF, 0xFF, 0x00, 0x08, 0x00, 0x00, 0xDE, 0x00, 0xFF, 0xFF, 0x00, 0x00, 0x40, 0x09, 0xED, 0x00, 0x00, 0x00, 0x40, 0x05, 0xEF, 0x00, 0x00, 0x00, 0x40, 0x01, 0xEE, 0x00, 0x00, 0x00, 0x10, 0x00, 0xED, 0x00, 0x00, 0x00, 0x20, 0x00, 0xEF, 0x00, 0x00, 0x00, 0x40, 0x00, 0xEE, 0x00, 0x00, 0x00, 0x00, 0x02, 0xF0, 0x00, 0x00, 0x00, 0x00, 0x01, 0xF0, 0x00, 0x00, 0x00, 0x00, 0x08, 0xF0, 0x00, 0x00, 0x00, 0x00, 0x04, 0xF0, 0x00, 0xFF, 0xFF, 0x08, 0xFC, 0x99, 0x00, 0x05, 0x22, 0x3A, 0xF6, 0x90, 0x60, 0x45, 0x4F, 0x46,];

    let loadingStatus = GenerateNewListItem('Loading test data...success!', ipsReaderStatusList);
    loadingStatus.classList.add('list-group-item-success');
    ReadIPSFile();
};

pageContainer.appendChild(testButton);

testButton.click();
// Initialize();